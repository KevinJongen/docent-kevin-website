<!doctype html>
<html lang="nl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Hoofdstuk 5 â€” Planten | Meneer Jongen</title>
    <meta name="description" content="Podcast, GPT-docent en begrippenlijst (Excel) voor hoofdstuk 5: Planten." />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {{ theme: {{ extend: {{ colors: {{ kevin: {{50:'#f1fdf4',100:'#e3fbe9',200:'#c1f4d1',300:'#92e9b3',400:'#5bdc93',500:'#2fcf77',600:'#1fa962',700:'#1a8550',800:'#166944',900:'#0f4a32'}} }} }} }} }};
    </script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  </head>
  <body class="min-h-screen bg-gradient-to-b from-kevin-100 via-kevin-50 to-white">
    <header class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pt-6">
      <a href="../index.html" class="text-kevin-800 hover:text-kevin-900 font-semibold">â† Terug naar start</a>
    </header>

    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-16">
      <section class="mt-6">
        <h2 class="text-2xl sm:text-3xl font-extrabold text-kevin-900">Hoofdstuk 5 â€” Planten</h2>
        <div class="mt-2 flex flex-wrap gap-2 text-sm">
          <a href="#podcast" class="px-3 py-1 rounded-lg bg-kevin-600 text-white font-semibold">ğŸ§ Podcast</a>
          <a href="#gpt" class="px-3 py-1 rounded-lg bg-white border border-kevin-300 text-kevin-900 font-semibold">ğŸ¤– GPT</a>
          <a href="#begrippen" class="px-3 py-1 rounded-lg bg-kevin-100 border border-kevin-200 text-kevin-900 font-semibold">ğŸ“– Begrippen</a>
        </div>
      </section>

      <section id="podcast" class="mt-8">
        <h3 class="text-xl font-bold text-kevin-900 mb-2">ğŸ§ Start hier: 5.2</h3>
        <div class="rounded-xl overflow-hidden border border-kevin-200 bg-white">
          <iframe style="border:0" width="100%" height="232" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy" src="https://open.spotify.com/embed/show/0meYrg7vp9bzt0TKTEOO92"></iframe>
        </div>
      </section>

      <section id="gpt" class="mt-10">
        <h3 class="text-xl font-bold text-kevin-900 mb-2">ğŸ¤– Stel je vragen aan je GPT-docent</h3>
        <p class="text-kevin-800/80 mb-4 text-sm">Hier kun je oefenen, vragen stellen en uitleg krijgen alsof je een docent naast je hebt.</p>
        <a href="#" target="_blank" rel="noopener"
           class="group inline-flex items-center gap-3 px-5 sm:px-6 py-3.5 sm:py-4 rounded-2xl bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold text-base sm:text-lg shadow-lg hover:shadow-xl hover:scale-[1.02] active:scale-[.99] transition">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" class="h-6 w-6 sm:h-7 sm:w-7 text-white">
            <path fill="currentColor" d="M37.532 16.87a9.963 9.963 0 0 0-.86-8.184 10.06 10.06 0 0 0-10.854-4.886A9.967 9.967 0 0 0 9.69 5.51a10.062 10.062 0 0 0-6.006 6.995 9.967 9.967 0 0 0 2.87 9.951 10.056 10.056 0 0 0 .86 8.185 10.06 10.06 0 0 0 10.854 4.886 9.966 9.966 0 0 0 16.128-1.71 10.062 10.062 0 0 0 6.005-6.995 9.965 9.965 0 0 0-2.869-9.952Z"/>
          </svg>
          <span>Chat met GPT</span>
        </a>
      </section>

      <section id="begrippen" class="mt-10">
        <h3 class="text-xl font-bold text-kevin-900">ğŸ“– Begrippenlijst</h3>

        <details id="begrippenDetails" class="mt-3 rounded-xl border border-kevin-200 bg-white">
          <summary class="cursor-pointer list-none px-4 py-3 flex items-center justify-between">
            <span class="font-semibold text-kevin-900">Toon/Verberg begrippen</span>
            <span id="begrippenCount" class="text-xs font-semibold bg-kevin-600 text-white rounded px-2 py-0.5">0</span>
          </summary>
          <div id="begrippenList" class="p-4 grid grid-cols-1 sm:grid-cols-2 gap-3"></div>
        </details>

        <div class="mt-8">
          <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
            <h4 class="font-bold text-kevin-900">Oefen jezelf</h4>
            <div class="flex items-center gap-2">
              <span id="score" class="inline-flex items-center rounded-lg bg-kevin-600 text-white text-sm font-bold px-3 py-1">Score: 0/0</span>
              <button id="resetQuiz" class="px-3 py-1 rounded-lg bg-white border border-kevin-300 text-kevin-900 text-sm font-semibold hover:bg-kevin-50">Opnieuw</button>
            </div>
          </div>
          <div id="quiz" class="mt-3 space-y-3"></div>
        </div>
        <p id="begrippenStatus" class="mt-3 text-sm text-kevin-800/70"></p>
      </section>
    </main>

    <footer class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-8">
      <p>Â© <span id="year"></span> Meneer Jongen â€” Hoofdstuk 5 â€” Planten</p>
    </footer>

    <script>
      document.getElementById('year').textContent = new Date().getFullYear();

      async function loadBegrippen(chNum){
        var status = document.getElementById('begrippenStatus');
        var list = document.getElementById('begrippenList');
        var countEl = document.getElementById('begrippenCount');
        var detailsEl = document.getElementById('begrippenDetails');
        var quiz = document.getElementById('quiz');
        var scoreEl = document.getElementById('score');
        var resetBtn = document.getElementById('resetQuiz');
        var url = '../data/hoofdstuk-' + chNum + '.xlsx';

        // Start ingeklapt
        detailsEl.removeAttribute('open');

        // Score state
        var score = 0, total = 0;
        function updateScore(){ scoreEl.textContent = 'Score: ' + score + '/' + total; }

        try {
          var res = await fetch(url);
          if(!res.ok) throw new Error('Bestand niet gevonden');
          var buf = await res.arrayBuffer();
          var workbook = XLSX.read(buf, { type: 'array' });
          var sheetName = workbook.SheetNames[0];
          var sheet = workbook.Sheets[sheetName];
          var rows = XLSX.utils.sheet_to_json(sheet, { defval: '' });

          var items = rows.filter(function(r){ return r['Begrip'] && r['Uitleg']; })
                          .map(function(r){ return { begrip: r['Begrip'], uitleg: r['Uitleg'] }; });

          // Lijst
          list.innerHTML = '';
          items.forEach(function(it){
            var card = document.createElement('div');
            card.className = 'p-4 rounded-xl border border-kevin-200 bg-white';
            var title = document.createElement('div'); title.className='font-semibold text-kevin-900'; title.textContent = it.begrip;
            var desc = document.createElement('div'); desc.className='text-kevin-800/80 text-sm mt-1'; desc.textContent = it.uitleg;
            card.appendChild(title); card.appendChild(desc);
            list.appendChild(card);
          });
          countEl.textContent = items.length;

          // Quiz
          quiz.innerHTML = '';
          score = 0;
          var n = Math.min(10, items.length);
          total = n; updateScore();

          function shuffle(a){ for(var i=a.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1)); var t=a[i]; a[i]=a[j]; a[j]=t;} return a; }
          var pool = shuffle(items.slice()).slice(0, n);

          for (let i = 0; i < n; i++) {
            const correct = pool[i];
            const distractors = shuffle(items.filter(function(it){return it !== correct;})).slice(0,2).map(function(it){return it.uitleg;});
            const options = shuffle([correct.uitleg].concat(distractors));

            const div = document.createElement('div'); div.className='p-3 border rounded-lg bg-white';
            const p = document.createElement('p'); p.className='text-sm sm:text-base'; p.textContent = (i+1) + '. Wat hoort bij "' + correct.begrip + '"?'; div.appendChild(p);
            const fb = document.createElement('div'); fb.className='mt-1 text-xs'; div.appendChild(fb);

            let counted = false;
            options.forEach(function(opt){
              const label=document.createElement('label'); label.className='flex items-start gap-2 mt-1 text-sm sm:text-base';
              const input=document.createElement('input'); input.type='radio'; input.name='q'+i; input.value=opt; input.className='mt-1 scale-110';
              label.appendChild(input); label.appendChild(document.createTextNode(opt)); div.insertBefore(label, fb);

              input.addEventListener('change', function(){
                if (opt === correct.uitleg) {
                  fb.textContent='âœ… Goed!'; fb.className='mt-1 text-xs text-green-700';
                  if (!counted) { score += 1; counted = true; updateScore(); }
                  const radios = div.querySelectorAll('input[type="radio"]'); radios.forEach(function(r){ r.disabled = true; });
                } else {
                  fb.textContent='âŒ Fout, probeer opnieuw.'; fb.className='mt-1 text-xs text-red-700';
                }
              });
            });

            quiz.appendChild(div);
          }

          resetBtn.onclick = function(){ loadBegrippen(chNum); };
          status.textContent = 'Ingeladen uit Excel (' + items.length + ' begrippen).';
        } catch(err) {
          status.textContent = 'Geen Excel gevonden voor dit hoofdstuk. (Zet een bestand in /data/hoofdstuk-__N__.xlsx met kolommen "Begrip" en "Uitleg".)';
          list.innerHTML = '';
          document.getElementById('begrippenCount').textContent = '0';
          quiz.innerHTML = '';
          score = 0; total = 0; updateScore();
          resetBtn.onclick = function(){ loadBegrippen(chNum); };
        }
      }

      loadBegrippen(5);
    </script>
  </body>
</html>